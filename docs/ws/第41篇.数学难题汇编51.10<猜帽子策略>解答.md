## 数学难题汇编51.10<猜帽子策略>解答

本文是《数学难题汇编【51】》中，第10题-猜帽子策略-的解法，答案由数学讨论群的朋友提供。

有 $n$ 个人， $2n-1$ 个不同编号的帽子，随机取 $n$ 个帽子戴到 $n$ 个人头上，每人只能看见其他人的帽子编号，看不见自己帽子编号和未分配帽子编号，现要求每人独立猜自己帽子编号，整个猜帽子过程不得交流，所有人都不会知道别人猜的是什么编号，

**问**：是否有策略保证至少有一个人猜对？

马戎的解法

设第 $i$ 个人看到的其他 $n-1$ 人所戴帽子编号之和为 $S_i$ ，则猜测 $(i-S_i)mod n$ ，其中 $i$ 为猜测者的序号， $i=0,1,...,n-1$ 。

如果 $(i-S_i)mod n=0$ ，则猜 $n$ ，如果 $(i-S_i)mod n$ 这个编号已经有其他人戴了，则猜 $((i-S_i)mod n)+n$ 。

帽子编号之和为： $S_i+W+T_i=\frac{2n(2n-1)}{2}=n(2n-1)\equiv 0 \pmod n$ ,

其中 $W$ 是未被任何人戴的那 $n-1$ 个帽子编号之和。 $T_i$ 是序号为 $i$ 的人头上所戴帽子编号。

由上式得 $W+T_i\equiv -S_i \pmod n$ ，

即 $W+i+T_i\equiv i-S_i \pmod n$ ，

因为 $i=0,1,...,n-1$ ，所以存在 $i=k$ ,满足 $W+k\equiv 0\pmod n$ ，

也就是对于第 $k$ 个人，有 $T_k\equiv k-S_k \pmod n$

不直接猜-Si mod n，而是猜i-Si，是实际上是覆盖了n个不同的W-i，若其中有一个W-i=0 mod n，则有一个猜测正确。这样猜测的号码共计n个不同的编号，同时任意人没有猜别人头上所戴帽子的编号。这样对于任意人来说，其他人即使都没有猜对，这些人猜的编号共计n-1个(都不同)，同时这些人头上所戴帽子的编号有n-1个，这共计2n-2个号码都被排除，最后剩下那个必是该人头上所戴帽子的编号。

这个策略仍然有漏洞。当W+i=0 mod n时，可能Ti=(Ti mod n)+n。可以采用双模余系统，用模n与2n来交叉检验。如果两个模余系统结果相同，则按照这个结果猜测；若两个结果不同，则按照2n的模余结果猜测。

另外，此原来可以用来做加密系统。​


拓展思考

10个囚犯的方法？
