## 数学难题汇编52.1<染成同色的期望>解答

本文是《数学难题汇编【52】》中，第1题-染成同色的期望-的解法，答案由数学讨论群的朋友提供。

一个坛子里有 ${\color{red}n}$ 个不同颜色的小球，然后每次取出两个，将第二个球染成第一个球的颜色，再把两个球都放回坛子里。

问：平均需要几次可以将 ${\color{red}n}$ 个球都染为同色？

Ez7r提供的解法

解答：

令 $M_n$ 为所有球变成同色所需的次数， $T_i$ 为所有球最后染为第 $i$ 种颜色对应的事件,

由期望值公式，我们有 $E(M_n)=\sum_{k=1}^nE(M_n|T_i)P(T_i)$

由对称性，我们有 $P(T_i)=\frac1n$ 和 $E(M_n|T_i)$

依据对称性，我们设最后所有球都被染为第 $1$ 种颜色,

即只需求 $E(M_n|T_i)$ ,

显然，除去第 $1$ 种颜色，剩下的第 $2,3,...,n$ 种颜色不影响 $E(M_n|T_i)$ ,

因此，我们可以把问题转化为只有两种颜色,

进而我们可以用 $n$ 个球中 $1$ 号颜色球的数量来表示所有球的状态,

利用 $P(T_1|x_k=i)=\frac{i}{n}$ 和 $P(T_1|x_{k+1}=i-1)=\frac{i-1}{n}$ ，我们可以推导出状态转移方程，即 

$E(M_n|T_1)=E(M_{i+1}|T_1)\times P_{i,i+1}|F_1+E(M_{i}|T_1)\times P_{i,i}|F_1+E(M_{i-1}|T_1)\times P_{i,i-1}|F_1+1$

其中 $P(x_{k+1}=i-1|x_k=i,T_1)=\frac{P(x_k=i,x_{k+1}=i-1,T_1)}{P(x_k=i,T_1)}$

$=\frac{P(T_1|x_{k+1}=i-1,x_k=i)\times P(x_{k+1}=i-1|x_k=i)\times P(x_k=i)}{P(T_1|x_k=i)\times P(x_k=i)}$

$=\frac{\frac{i-1}{n}\times \frac{i(n-1)}{n(n-1)}}{\frac{i}{n}}=\frac{(n-i)(i-1)}{n(n-1)}$

所以，对于 $n$ 种颜色的状态，每种颜色成为最后统一的颜色的概率均为 $\frac{1}{n}$ ,

设有 $i$ 个球颜色为 $W$ ，我们将它们的颜色标为 $W_m,m=1,2,...,i$ ,尽管它们都是同一个颜色 $W$ ,

这 $i$ 个球颜色均为 $W$ ，概率为 $\frac{1}{n}$ ， $W$ 的概率是 $W_m$ 的概率之和，进而得到 $\frac{1}{n}$ 的结果,

接下来，我们计算 $P(x_{k+1}=i-1|x_k=i)$

它可以理解为从 $n$ 个球中选择 $2$ 个球有 $n(n-1)$ 种可能得排列组合，先选择第 $2$ 个球（也就是要改变颜色的那个球），它有 $i$ 种选择，第 $1$ 个球则有 $n-i$ 种选择，

所以，我们得到 $P(x_{k+1}=i-1|x_k=i)=\frac{i(n-i)}{n(n-1)}$ ,

同理，我们进一步得到

$P(x_{k+1}=i+1|x_k=i,T_1)=\frac{(n-i)(i+1)}{n(n-1)}$

 和 $P(x_{k+1}=i|x_k=i,T_1)=1-\frac{2i(n-i)}{n(n-1)}$

记 $A_i=E(M_i|T_1)$ ，将上述代入状态转移方程

我们得到 $2iZ_i=(i-1)Z_{i-1}+(i+1)Z_{i+1}+\frac{n(n-1)}{n-i}$

结合 $Z_n=0$ ，解该递归方程

得 $Z_1=(n-1)^2$

即平均需要 $(n-1)^2$ 次。







